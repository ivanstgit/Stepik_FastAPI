# Обработка событий WebSocket
Маршруты WebSocket в FastAPI могут обрабатывать различные события (созданные функции):

`on_connect`: это событие запускается, когда клиент подключается к маршруту WebSocket (например, `websocket.accept()`) .

`on_disconnect`: это событие запускается, когда клиент отключается от маршрута WebSocket (например, `websocket.close()`).

`on_message`: это событие запускается, когда сервер получает сообщение от клиента (например, `websocket.recieve_text()` или `websocket.send_text()`). 

# Двунаправленная связь
Как только соединение с WebSocket установлено, и клиент, и сервер могут отправлять сообщения друг другу асинхронно. Это обеспечивает обмен данными и обновления в режиме реального времени, обеспечивая бесперебойный пользовательский интерфейс для приложений реального времени.

# Безопасность веб-сокета
FastAPI поддерживает аутентификацию WebSocket, позволяя вам защищать маршруты WebSocket и ограничивать доступ только для прошедших проверку подлинности пользователей. Вы можете использовать те же механизмы аутентификации, которые используются в обычных HTTP-маршрутах, такие как OAuth2 или JWT.

# Example
Как видно из кода, у нас есть отдельный веб-сокет роут (/ws/), который мы сделали с использованием соответствующего декоратора. Наша асинхронная конечная точка (websocket_endpoint) будет удерживать соединение.

В этой точке мы сначала принимаем (акцептируем) вебсокет-соединение. Далее добавляем клиента в список подключённых. Потом в бесконечном цикле мы "слушаем" соединения (ждём получения текста). Если получили, то отправили это сообщение обратно, чуть изменив. Если клиент отключается, то мы его удаляем из нашего списка и цикл прерывается.

Дополнительно мы создали обычный роут для получения сообщений. Если сообщение получим, то разошлем его всем вебсокет-клиентам из списка. 